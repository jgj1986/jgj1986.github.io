---
title: c++ 知识点
date: 2015-11-04 14:12:28
tags: Language
- a
- b
---



## creatediries
使用boost::filesystem 创建目录的代码：

    #include "boost/filesystem.hpp"
    #include <iostream>
    int main() {
        boost::filesystem::path dir("/tmp/test");
    boost::system::error_code ec;
    try {
            if (boost::filesystem::create_directories(dir, ec))
            std::cout << "success create" << std::endl;
        } catch (...) {
            std::cout << "Unexpedted exception. [error='" <<  ec.message().c_str() << "']";
    }
    return 0;
    }
    
而如果将路径换成 "/tmp/test/" 的时候，create_direcotries的执行结果为false，但是ec的信息还是"Success"，这就 ^_^ ...

## C++11 的一些特性
 [C++11新特性](http://blog.csdn.net/augusdi/article/details/11773163){:target="_blank"}。C++11标准引入了一些新特性，这最近的使用中就遇到了一次。

    #define VALIDATE_PARAMS(index, name, vars, type, def_value) \
    do { \ 
        vars = m_conf_root[catalog].get(name, def_value).as##type(); \
        if (def_value == vars) { \
    PUSHER_LOG_WARNING("Params isn't defined. [param='%s']", "["index"]"name); \
        return ERROR; \
        } \
    } while(0)
                                                                          
    VALIDATE_PARAMS("coco", "import_things", m_output_path, String, "_");

编译的时候会有错误提示：
    
    error: inconsistent user-defined literal suffixes ‘index’ and ‘name’ in string literal
    error: unable to find string literal operator ‘operator"" index’

因为C++11中对用户自定义的语法强制要求要有空格。所以上面的一行必须如下定义：

    PUSHER_LOG_WARNING("Params isn't defined. [param='%s']", "[" index"]" name); \


## 小知识点

判断字符串是否以 'xxx' 结尾

    #define ENDSWITH(str, suffix)   \                         
    ((str).rfind(suffix) == (str).size() - strlen(suffix))

find返回suffix在str的索引，rfind则是从后向前查找。

