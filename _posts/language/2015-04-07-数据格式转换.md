---
title: 数据格式转换
date: 2015-04-07 15:12:28
tags: 语言  
- a
- b
---

* toc 
{:toc}

>很多语言中有或严格或非严格的变量类型要求，而实际的编码的过程中，又难免需要一定的类型转换。

##数字转字符串
数字转字符串或字符串转数字，是比较常见的类型转换。
### C/C++

    # include <stdio.h>
    # include <stdlib.h>
    void main (void){
        int num = 100;
        char str[25];
        itoa(num, str, 10);
    }
    
C语言提供了几个标准库函数，可以将任意类型(整型、长整型、浮点型等)的数字转换为字符串，下面列举了各函数的方法及其说明。

● itoa()：将整型值转换为字符串。
● ltoa()：将长整型值转换为字符串。
● ultoa()：将无符号长整型值转换为字符串。
● gcvt()：将浮点型数转换为字符串，取四舍五入。
● ecvt()：将双精度浮点型值转换为字符串，转换结果中不包含十进制小数点。
● fcvt()：指定位数为转换精度，其余同ecvt()。

### C++
to Char*

    char str[10];
    int a=123;
    sprintf(str,"%d",a);

或用指针操作，存放信息，没有实际放在字符串中。
 
    *((int *)str) = a;
    printf("%d\n", *((int *)str));
  
to string

    #include <sstream>
    #Include <string>
    string num2str(double i){
        stringstream ss;
        ss<<i;
        // ss.c_str(); // to char*
        return ss.str();
    }
    
###python

    int a = 123
    str = str(123)
    
###go

    import (
      "fmt"
    "strconv"
    )
    function main() {
        a := 123
        f := 12.3
        str := strconv.Itoa(a)
        fmt.Println("%s\n",str)
        str = strconv.FormatFloat(a,'f', -1, 64)
        fmt.Println("%s\n",str)
        str = toString(a)
    }
    
###shell

bash shell中没有明确的数字和字符串之分，但是在一些进行判断的时候，需要小心，这里不多描述。      
    
##字符串转数字
### C/C++

    char str[]="123";
    int a;
    sscanf(str,"%d",&a);
    
    // or
    a = atoi(str);
    
注意是 char* 而不是 string

### C++

    istringstream stream1;
    string string1 = "25";
    stream1.str(string1);
    int i;
    stream1 >> i;
    
### go

    str := "123"
    a,error := strconv.Atoi(a)
   
### python

    str = "123"  
    a = int(str)
    
##对象类型转化

###C++
static_cast  
 最常用的类型转换符，在正常状况下的类型转换，如把int转换为float，如：int i；float f； f=（float）i；或者f=static_cast<float>(i);
 
const_cast  
  用于取出const属性，把const类型的指针变为非const类型的指针，如：const int *fun(int x,int y){}　　int *ptr=const_cast<int *>(fun(2.3))

dynamic_cast

  该操作符用于运行时检查该转换是否类型安全，但只在多态类型时合法，即该类至少具有一个虚拟方法。
dynamic_cast与static_cast具有相同的基本语法，dynamic_cast主要用于类层次间的上行转换和下行转换，还可以用于类之间的交叉转换。
在类层次间进行上行转换时，dynamic_cast和static_cast的效果是一样的；在进行下行转换时，dynamic_cast具有类型检查的功能，比static_cast更安全。

reinterpret_cast  
interpret是解释的意思，reinterpret即为重新解释，此标识符的意思即为数据的二进制形式重新解释，但是不改变其值。

网上的介绍还是比较多的 [C++中类型转换](http://blog.chinaunix.net/uid-25132162-id-2938837.html){:target="_blank"}、
[C++类型转换总结](http://www.cnblogs.com/goodhacker/archive/2011/07/20/2111996.html){:target="_blank"}、
[类型转换和类型安全（现代 C++）](https://technet.microsoft.com/zh-cn/magazine/hh279667.aspx){:target="_blank"}。

###go
为了适应出现的各种情况，go中经常定义返回的接口为 `[]interface{}`，如果我们已经能确定里面的类型是int、或string类型时，如何转换。

