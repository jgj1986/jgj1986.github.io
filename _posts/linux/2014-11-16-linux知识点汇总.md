---
title:  Linux知识点汇总
date: 2014-11-16 16:12:28 +0800
tags: linux 
- a
- b
---

* toc 
{:toc}


###md5

使用md5sum命令得到的md5，和用md5.lua得到的md5值不一样，如下：

    $ echo "hello" | md5sum
    b1946ac92492d2347c6235b4d2611184  -
    
使用md5.lua进行测试

    $ lua
    Lua 5.1.4  Copyright (C) 1994-2008 Lua.org, PUC-Rio
    > print(require("md5").sumhexa("hello"))
    5d41402abc4b2a76b9719d911017c592    

这就比较奇怪了，md5加密的算法应该是为唯一的，怎么还会不一样呢？经过搜素，原来是echo中的回车导致的：

    $ echo -n "hello" | md5sum
    5d41402abc4b2a76b9719d911017c592  -

###redis乱码

在redis 中存储中文，读取会出现乱码，如何在get时取到它的中文呢？只需要在redis-cli 后面加上 `--raw`

    ./redis-cli --raw
    redis> get test
    "我们"
    
###ssh免密码登录

第一创建时，将机器A的id_dsa.pub的内容，直接写到（比如用vim打开）机器B的authorized_keys中，及时将权限修改正确

    ls -l /home/work/.ssh
    -rw-rw-r-- 1 work work  2379 May 26  2014 authorized_keys
    -rw------- 1 work work   668 Dec 30  2013 id_dsa
    -rw-r--r-- 1 work work   599 Dec 30  2013 id_dsa.pub
    -rw-r--r-- 1 work work 20836 Nov 18 20:38 known_hosts

这个时候，也是往往不生效，而直接使用

    cat id_dsa.pub > ~/.ssh/authorized_keys

则往往可以。


###python快速搭建http服务

在线上服务器拷贝文件的方法：
在服务器的相应文件目录下，用python开启一个服务

    python -m SimpleHTTPServer 8080  #(端口)
    
本地下载相应文件

    wget "http://ip:8088/filename"
    
###MySQL中的Ctrl C

mysql中输入了一些命令后，发现有问题，或者这条命令不是我们想要的，直接 `Ctrl-C` ，就退出MySQL了。

可以用 `home`键 或 `Ctrl-a-a` 到命令行首，输入 `#` ，然后回车即可。

可以理解为注释掉这行，不让他执行了。


###编码转义

    iconv -f gbk -t utf8 file > new_file
    
###vim特殊字符

vim中有^M ^B ^A的形式，怎么样替换呢，或怎么样输入了

    :%s/^M/|/g，

其中输入是Ctrl-v Ctrl-m

###一些Date命令

前一天
    # date --date='1 days ago' +%Y-%m-%d
    # date -d '1 days ago' +%Y-%m-%d
    # date -d yesterday +%Y-%m-%d
    # date -d yesterday +%Y-%-m-%-d
明天
    # date --date='1 days' +%Y-%m-%d
    # date -d '1 days' +%Y-%m-%d
    # date -d tomorrow +%Y-%m-%d
    
时间与时间戳
    
    date -d "2013-12-12 00:00:00" +%s
    date -d @1386777600  "+%Y%m/%d"
    date -d @1386777600  "+%Y-%m-%d %H:%M:%S"   
    date --date='1 hour ago' +%Y%m%d%H%M

###sort
sort使用-t指定分隔符，默认的是'\t'和' '，如果限制是'\t'的话，需要使用$符号，也就是
 
    sort -t $'\t'    

###查看安装的linux发行版

     cat /etc/issue
     lsb_release -a
     cat /proc/version

###查看glibc版本

      rpm -qi glibc
      ldd --version   
      /lib/libc.so.6

###tmux假死

tmux是开发的利器。在实际使用过程中，遇到到假死的现象，即进去到某个session中，光标没有反应，但是可以正常的切换等。  
使用`Ctrl +  Q` 命令可以恢复。注意不是 'Ctrl-B + Q '

###sort
sort使用-t指定分隔符，默认的是'\t'和' '，如果限制是'\t'的话，需要使用$符号，也就是 
    sort -t $'\t' 
    
###grep与awk结果不同
先看看几个命令统计的结果

    $ cat */* | awk -F'^B' '{if ($3="394428706") print $5}' |sort | uniq | wc -l
    79489
    $ cat */* |grep "394428706" |  awk -F'^B' '{print $5}' | sort | uniq | wc -l
    2913
    $ grep 394428706 */*  |  awk -F'^B' '{print $5}' | sort |uniq | wc -l
    791
    
分析日志文件，看到里面有这样的内容：
    
        ... ^B42218def915cbdb7^B^@^@:^@^@:^@^@:^@^@:^@^@:^@^@^B865163021157151^B^B^B1.2.0^B4^B^B    
        
后面在执行的时候就受到影响。为什么呢?

    man awk: 
    awk cannot handle ascii NUL \0 in the source or data files

写段c代码可以看到 \0 的输出
    
    #include <stdio.h>
    int main(int argc, char *argv[]) {
        printf("##%c###\n", '\0');
        return 0;
    }

在vim中看到输出 ##^@###，这样awk处理时会就有问题！
 

###ab工具安装
ubuntu: aptitude install apache2-utils
centos: yum install httpd-tools.x86_64

