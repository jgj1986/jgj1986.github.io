---
title:  beego学习
date: 2014-11-25 15:12:28 +0800
tags: go 
- a
- b
---

* toc 
{:toc}
 beego学习

> 技术真是学不完啊，这两天用go语言编程，使用beego框架，感觉还是蛮好用的。[beego官网](http://beego.me/){:target="_blank"}上有比较详细的介绍说明，这里只是将使用过程记录下。

### 环境

首先，认为是已经安装好了go的编译环境（可参考[安装](https://golang.org/doc/install){:target="_blank"}、[设置环境变量GOPATH](https://golang.org/doc/code.html){:target="_blank"}），简单过程如下：

    $ wget https://storage.googleapis.com/golang/go1.3.3.linux-amd64.tar.gz
    $ tar go1.3.3.linux-amd64.tar.gz
    $ export GOROOT=/path/to/go
    $ export GOPATH=/path/for/go/workspace
    $ export PATH=$PATH:$GOROOT/bin:$GOPATH/bin
    $ go version
    go version go1.3.3 linux/amd64

然后下载运行beego所需的相关库和工具

    $ go get github.com/astaxie/beego   # beego会下载安装到$GOPATH的目录下
    $ go get github.com/beego/bee       # 会在$GOPATH/bin目录下生成bee
    
bee 工具是一个为了协助快速开发 beego 项目而创建的项目，参考 [bee 工具简介](http://beego.me/docs/install/bee.md){:target="_blank"}了解更多！
    
### 创建

直接使用bee工具来快速创建一个新项目(如 Fengzi)；可使用bee工具命令参数编译运行项目
    
    $ cd $GOPATH/src
    $ bee new Fengzi    # 新建项目
    $ cd Fengzi
    $ bee run                       # 该命令会编译出可执行文件 Fengzi，并运行
    
默认的项目使用8080端口，访问url `http://ip:8080` 即可访问这个简单的例子。
    
### json输出

beego的架构采用mvc模式，上面创建的简单项目中有models，views和controllers。main.go通过router调用controllers中的业务，由views显示。   
而在自己的业务中，不需要复杂的页面展示，只需要以json格式提供返回数据即可。
    
    func (c *MainController) Get() {
        c.Data["json"] = map[string]string{"ObjectId": "aaa"}
        c.ServeJson()
    }
    
上面代码中填充对象 `Data["json"]` 的内容，然后通过 c.ServeJson 返回。在测试时发现，beego更底层使用了Output来做输出：
    
    func (c *MainController) Get() {
        c.Ctx.Output.SetStatus(202)
        c.Ctx.Output.Body([]byte("yes!!"))
    }
    
这么修改controllers/default.go之后，可在访问下接口，看看得到的结果。

beego中 支持多种格式的输出，JSON、XML、JSONP，例如使用xml格式输出，代码如下：

    this.Data["xml"]=&mystruct
    this.ServeXml()
    
###路由

应用中的大多数路由都会定义在 routers/router.go，现在新的版本识别 RESTful 格式的url，除了一些基础的路由，现在支持自定义规则以及正则表达

    beego.Router("/api/list",&RestController{},"*:ListFood")
    beego.Router("/api/create",&RestController{},"post:CreateFood")
    beego.Router("/api/update",&RestController{},"put:UpdateFood")
    beego.Router("/api/delete",&RestController{},"delete:DeleteFood")   
    

###Revel
无意中看到一篇关于  [Revel和Beego的论战](http://neue.v2ex.com/t/89374){:target="_blank"}，了解到还有 Revel这个工具，看了下[他的中文社区](http://www.gorevel.cn/){:target="_blank"}，感觉用起来也是蛮方便的。
